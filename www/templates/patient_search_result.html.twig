<!doctype html>
<html
	lang="en">
	<!-- Calling method head.html.twig-->
	{% include "partial/head.html.twig" %}
	<body>
		{% include "partial/navigation.html.twig" %}

		<div class="container">
			<ul class="nav nav-pills gap-3 mb-5">
				<li class="nav-item">
					<a class="nav-link fw-bold bg-secondary text-white" aria-current="page" href="/">
						<i class="fa-sharp fa-light fa-house-medical fa-xl" style="color: #ffffff;"></i> Home
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link fw-bold active bg-primary text-white" href="patient.php">
					<i class="fa-sharp fa-solid fa-users-medical fa-xl"></i> Patients</a>
				</li>
			</ul>

			{# <h2 class="text-center">
			<i class="fa-sharp fa-solid fa-users-medical" style="color: #000000;"></i> Patients</h2> #}

			{% if notFoundMessage | length > 0 %}
				<a href="patient.php" style="display:flex">Back to patients</a>
			{% else  %}
				<a href="patient.php" style="display:none">Back to patients</a>
			{% endif  %}

			<!-- Search and Status box -->
			<form id="patientSearchAndStatus" method="post" action="patient_search_result.php">
				<div class="row justify-content-between my-3">

					<div class="col-md-6">
						<label for="seacrh" class="form-label fw-bold">Patient name</label>
						<div class="input-group mb-3">
							<input type="text" class="form-control" name="inputName" id="inputName" placeholder="Search patient here..." aria-label="Patient's name" aria-describedby="Type patient's name here">
							<button class="btn btn-secondary" type="submit" name="searchBtn" id="searchBtn" disabled>Search</button>
						</div>
					</div>
					<div class="col-md-3">
						<label for="status" class="form-label fw-bold">Status</label>
						<div class="input-group">
							<select class="form-select" name="statusSelected" id="status" aria-label="status">
								{% if search_result_count | length > 0 and statusSelected == "all" %}
									<option value="all" selected>All</option>
									<option value="active">Active</option>
									<option value="deceased">Deceased</option>
									<option value="discharged">Discharged</option>
									<option value="transferred">Transferred</option>
									<option value="wait listed">Wait listed</option>
								{% elseif search_result_count | length > 0 and statusSelected == "active" %}
									<option value="all">All</option>
									<option value="active" selected>Active</option>
									<option value="deceased">Deceased</option>
									<option value="discharged">Discharged</option>
									<option value="transferred">Transferred</option>
									<option value="wait listed">Wait listed</option>
								{% elseif search_result_count | length > 0 and statusSelected == "deceased" %}
									<option value="all">All</option>
									<option value="active">Active</option>
									<option value="deceased" selected>Deceased</option>
									<option value="discharged">Discharged</option>
									<option value="transferred">Transferred</option>
									<option value="wait listed">Wait listed</option>
								{% elseif search_result_count | length > 0 and statusSelected == "discharged" %}
									<option value="all">All</option>
									<option value="active">Active</option>
									<option value="deceased">Deceased</option>
									<option value="discharged" selected>Discharged</option>
									<option value="transferred">Transferred</option>
									<option value="wait listed">Wait listed</option>
								{% elseif search_result_count | length > 0 and statusSelected == "transferred" %}
									<option value="all">All</option>
									<option value="active">Active</option>
									<option value="deceased">Deceased</option>
									<option value="discharged">Discharged</option>
									<option value="transferred" selected>Transferred</option>
									<option value="wait listed">Wait listed</option>

								{% elseif search_result_count | length > 0 and statusSelected == "wait listed" %}
									<option value="all">All</option>
									<option value="active">Active</option>
									<option value="deceased">Deceased</option>
									<option value="discharged">Discharged</option>
									<option value="transferred">Transferred</option>
									<option value="wait listed" selected>Wait listed</option>
								{% endif  %}
							</select>
							<button class="btn btn-primary" type="submit" name="statusBtn" id="statusBtn">Search</button>
						</div>
					</div>
				</div>
			</form>

			{% if search_result_count | length > 0 %}

				<!-- Error found message -->
				{% if notFoundMessage | length > 0 %}
					<p class="alert alert-warning" style="display:flex">{{notFoundMessage}}</p>
				{% else  %}
					<p class="alert alert-warning" style="display:none">{{notFoundMessage}}</p>
					<div class="container container-body px-5 py-3 my-3 shadow-sm rounded" style="background-color: gray; color:white">
						<div class="row justify-content-between">
							<div class="col-9">
								<p class="fw-bold " id="patient-name">Patients</p>
							</div>
							<div class="col-3">
								<p class="fw-bold text-end">Room</p>
							</div>
						</div>
					</div>
				{% endif  %}

				<!-- List of Searched Patients -->
				{% for item in search_result %}
					<div class="container container-body px-5 py-3 my-3 shadow-sm rounded">
						<div class="row justify-content-between align-items-center">
							<div class="col-md-2">
								<img src="img/patient/{{ item.patient_image}}" class="img-fluid rounded overflow-hidden" alt="patient image">
							</div>
							<div class="col-md-7">
								<p class="fw-bold fs-5 text-capitalize" id="patient-name">{{ item.first_name}}
									{{ item.last_name }}</p>
								<span class="navbar-text text-capitalize">
									DOB:
									{{ patient.date_of_birth | date("d F Y")}}
									| Age:
									{{ item.age }}
								</span>
							</div>

							<div class="col-md-3">
								<p class="fst-italic text-capitalize text-end">Room
									{{ item.room }} |
									{{ item.ins_name }}</p>
								<form action="view-patient-profile.php" method="POST">
									<input type="hidden" name="patient_ID" value="{{item.patient_ID}}">
									<p class="d-grid text-end">
										<button class="btn btn-primary mt-3" type="submit"><i class="fa-sharp fa-light fa-magnifying-glass" style="color: #ffffff;"></i> View</button>
									</p>
								</form>
								<p class="d-grid mt-3">						
									<a class="btn btn-primary" href="edit-patient-information.php?patient_ID={{item.patient_ID}}"><i class="fa-sharp fa-light fa-pen-to-square" style="color: #ffffff;"></i> Edit</a>
								</p>

							</div>
						</div>
					</div>
				{% endfor %}

			{% else %}

				<!--No patient found-->
				<div class="container container-body px-5 py-3 my-3 shadow-sm rounded" style="background-color: gray; color:white">
					<div class="row justify-content-between">
						<div class="col-9">
							<p class="fw-bold " id="patient-name">Patients</p>
						</div>
						<div class="col-3">
							<p class="fw-bold text-end">Room</p>
						</div>
					</div>
				</div>

			{% endif %}

			<div class="d-grid">
				<a href="add_patient.php" type="button" name="add-patient-btn" class="btn btn-primary btn-lg mt-5" id="add-patient-btn">
					<strong>Add new patient</strong>
				</a>
			</div>
		</div>
		{% include "partial/footer.html.twig" %}
		{% include "partial/script.html.twig" %}
		<script src="js/patient_v6.js" defer></script>
	</body>
</html>
